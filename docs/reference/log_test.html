
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Log Test &#8212; Merkely  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/merkely-custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-4.6.0/css/bootstrap.min.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/merkely-custom.js"></script>
    <script src="../_static/bootstrap-4.6.0/js/bootstrap.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Control Pull Request" href="control_pull_request.html" />
    <link rel="prev" title="Log Evidence" href="log_evidence.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/w-merkely-white.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
      <p class="caption">
 <span class="caption-text">
  Table of contents
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorial/index.html">
   Quick Start
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../concepts/index.html">
   Concepts
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Command Reference
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="declare_pipeline.html">
     Declare Pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="log_artifact.html">
     Log Artifact
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="log_evidence.html">
     Log Evidence
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Log Test
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="control_pull_request.html">
     Control Pull Request
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="approve_deployment.html">
     Approve Deployment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="request_approval.html">
     Request Approval
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="control_deployment.html">
     Control Deployment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="log_deployment.html">
     Log Deployment
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fingerprints/index.html">
   Fingerprint Reference
  </a>
 </li>
</ul>

    </div>
  </nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="log-test">
<span id="log-test-label"></span><h1>Log Test<a class="headerlink" href="#log-test" title="Permalink to this headline">¶</a></h1>
<p><span>Logs JUnit xml format test summary evidence in Merkely. The JUnit xml format is used by many tools, not just testing frameworks. By default, looks for JUnit .xml files in the </span><span class="inline-code">/data/junit/</span><span> dir.</span></p>
<ul class="nav nav-tabs">
   <li class="active"><a data-toggle="tab" href="#docker">Docker</a></li>
   <li><a data-toggle="tab" href="#bitbucket">Bitbucket</a></li>
   <li><a data-toggle="tab" href="#github">Github</a></li>
</ul>

<div class="tab-content"><div class="docker tab-pane active docutils container" id="docker">
<p class="literal-block-link"><a class="reference external" href="https://github.com/merkely-development/change/blob/main/Makefile#L207">Open an example, similar to the fragment below, from a git repo.</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>docker run \
    --env MERKELY_COMMAND=log_test \
    --env MERKELY_FINGERPRINT=&quot;${MERKELY_FINGERPRINT}&quot; \
    --env MERKELY_EVIDENCE_TYPE=&quot;${MERKELY_EVIDENCE_TYPE}&quot; \
    --env MERKELY_TEST_RESULTS_DIR=&quot;${MERKELY_TEST_RESULTS_DIR}&quot; \
    --env MERKELY_DESCRIPTION=&quot;${MERKELY_DESCRIPTION}&quot; \
    --env MERKELY_CI_BUILD_URL=&quot;${MERKELY_CI_BUILD_URL}&quot; \
    --env MERKELY_USER_DATA=&quot;${MERKELY_USER_DATA}&quot; \
    --env MERKELY_OWNER=&quot;${MERKELY_OWNER}&quot; \
    --env MERKELY_PIPELINE=&quot;${MERKELY_PIPELINE}&quot; \
    --env MERKELY_API_TOKEN=&quot;${MERKELY_API_TOKEN}&quot; \
    --env MERKELY_HOST=&quot;${MERKELY_HOST}&quot; \
    --env MERKELY_DRY_RUN=&quot;${MERKELY_DRY_RUN}&quot; \
    --rm \
    --volume ${YOUR_TEST_RESULTS_DIR}:/data/junit/ \
    --volume /var/run/docker.sock:/var/run/docker.sock \
    merkely/change:latest
</pre></div>
</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>ENV_VAR_NAME</p></th>
<th class="head"><p>Required?</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MERKELY_COMMAND</p></td>
<td><p>yes</p></td>
<td><p><span>The Merkely command to execute. This page documents a value of </span><span class="inline-code">log_test</span><span></span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_FINGERPRINT</p></td>
<td><p>yes</p></td>
<td><p>The artifact’s <a class="reference external" href="../../fingerprints/docker_fingerprint.html">Fingerprint</a></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_EVIDENCE_TYPE</p></td>
<td><p>yes</p></td>
<td><p><span>The evidence type.</span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_TEST_RESULTS_DIR</p></td>
<td><p>no</p></td>
<td><p><span>The directory where Merkely will look for JUnit .xml files. Must be volume-mounted in the container. Defaults to </span><span class="inline-code">/data/junit/</span><span></span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_DESCRIPTION</p></td>
<td><p>no</p></td>
<td><p><span>A description of the test summary. Defaults to “JUnit results xml verified by merkely/change: ” followed by a summary, eg “All tests passed in 1 test suites”</span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_CI_BUILD_URL</p></td>
<td><p>yes</p></td>
<td><p><span>Link to the build in the ci system.</span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_USER_DATA</p></td>
<td><p>no</p></td>
<td><p><span>A pathed filename containing json content to embed in the data logged to Merkely. If provided, must be volume-mounted in the container. If not provided, the json content defaults to </span><span class="inline-code">{}</span><span></span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_OWNER</p></td>
<td><p>yes</p></td>
<td><p><span>Your user/organization name in Merkely.</span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_PIPELINE</p></td>
<td><p>yes</p></td>
<td><p><span>Your pipeline name in your user/organization in Merkely.</span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_API_TOKEN</p></td>
<td><p>yes</p></td>
<td><p><span>Your secret API token for Merkely. Set this to </span><span class="inline-code">“DRY_RUN”</span><span> to turn off all commands in all pipelines.</span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_HOST</p></td>
<td><p>no</p></td>
<td><p><span>The API hostname for Merkely. Defaults to </span><span class="inline-code">https://app.merkely.com</span><span></span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_DRY_RUN</p></td>
<td><p>no</p></td>
<td><p><span>When set to </span><span class="inline-code">“TRUE”</span><span>, prints the command’s url+payload, does not make any HTTP calls to Merkely, and exits the command with a zero status code. Defaults to </span><span class="inline-code">“FALSE”</span><span>. See also setting the MERKELY_API_TOKEN (above) to code:`DRY_RUN`.</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="bitbucket tab-pane docutils container" id="bitbucket">
<p class="literal-block-link"><a class="reference external" href="https://bitbucket.org/merkely/loan-calculator/src/eb96cd3/bitbucket-pipelines.yml#lines-90">Open an example, similar to the fragment below, from a git repo.</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    - step: &amp;log_unit_test_results_in_merkely
        name: Log unit test results in Merkely
        services: [ docker ]
        script:
          - *export_merkely_fingerprint_env_vars
          - pipe: docker://merkely/change:latest
            variables:
              MERKELY_COMMAND: log_test
              MERKELY_FINGERPRINT: ${MERKELY_FINGERPRINT}
              MERKELY_EVIDENCE_TYPE: unit_test
              MERKELY_TEST_RESULTS_DIR: ${PWD}/build/test/
              MERKELY_OWNER: ${MERKELY_OWNER}
              MERKELY_PIPELINE: ${MERKELY_PIPELINE}
              MERKELY_API_TOKEN: ${MERKELY_API_TOKEN}
</pre></div>
</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>ENV_VAR_NAME</p></th>
<th class="head"><p>Required?</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MERKELY_COMMAND</p></td>
<td><p>yes</p></td>
<td><p><span>The Merkely command to execute. This page documents a value of </span><span class="inline-code">log_test</span><span></span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_FINGERPRINT</p></td>
<td><p>yes</p></td>
<td><p>The artifact’s <a class="reference external" href="../../fingerprints/docker_fingerprint.html">Fingerprint</a></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_EVIDENCE_TYPE</p></td>
<td><p>yes</p></td>
<td><p><span>The evidence type.</span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_TEST_RESULTS_DIR</p></td>
<td><p>no</p></td>
<td><p><span>The directory where Merkely will look for JUnit .xml files. Must be volume-mounted in the container. Defaults to </span><span class="inline-code">/data/junit/</span><span></span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_DESCRIPTION</p></td>
<td><p>no</p></td>
<td><p><span>A description of the test summary. Defaults to “JUnit results xml verified by merkely/change: ” followed by a summary, eg “All tests passed in 1 test suites”</span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_CI_BUILD_URL</p></td>
<td><p>no</p></td>
<td><p><span>Link to the build in the ci system. Defaults to </span><span class="inline-code">https://bitbucket.org/${BITBUCKET_WORKSPACE}/${BITBUCKET_REPO_SLUG}/addon/pipelines/home#!/results/${BITBUCKET_BUILD_NUMBER}</span><span></span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_USER_DATA</p></td>
<td><p>no</p></td>
<td><p><span>A pathed filename containing json content to embed in the data logged to Merkely. If provided, must be volume-mounted in the container. If not provided, the json content defaults to </span><span class="inline-code">{}</span><span></span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_OWNER</p></td>
<td><p>yes</p></td>
<td><p><span>Your user/organization name in Merkely.</span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_PIPELINE</p></td>
<td><p>yes</p></td>
<td><p><span>Your pipeline name in your user/organization in Merkely.</span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_API_TOKEN</p></td>
<td><p>yes</p></td>
<td><p><span>Your secret API token for Merkely. Set this to </span><span class="inline-code">“DRY_RUN”</span><span> to turn off all commands in all pipelines.</span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_HOST</p></td>
<td><p>no</p></td>
<td><p><span>The API hostname for Merkely. Defaults to </span><span class="inline-code">https://app.merkely.com</span><span></span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_DRY_RUN</p></td>
<td><p>no</p></td>
<td><p><span>When set to </span><span class="inline-code">“TRUE”</span><span>, prints the command’s url+payload, does not make any HTTP calls to Merkely, and exits the command with a zero status code. Defaults to </span><span class="inline-code">“FALSE”</span><span>. See also setting the MERKELY_API_TOKEN (above) to code:`DRY_RUN`.</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="github tab-pane docutils container" id="github">
<p class="literal-block-link"><a class="reference external" href="https://github.com/merkely-development/loan-calculator/blob/main/.github/workflows/master_pipeline.yml#L72">Open an example, similar to the fragment below, from a git repo.</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    - name: Log unit test results in Merkely
      uses: docker://merkely/change:latest
      env:
        MERKELY_COMMAND: log_test
        MERKELY_FINGERPRINT: docker://${{ env.IMAGE_TAGGED }}
        MERKELY_EVIDENCE_TYPE: unit_test
        MERKELY_TEST_RESULTS_DIR: ${{ github.workspace }}/build/test
        MERKELY_OWNER: ${{ env.MERKELY_OWNER }}
        MERKELY_PIPELINE: ${{ env.MERKELY_PIPELINE }}
        MERKELY_API_TOKEN: ${{ secrets.MERKELY_API_TOKEN }}
</pre></div>
</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>ENV_VAR_NAME</p></th>
<th class="head"><p>Required?</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MERKELY_COMMAND</p></td>
<td><p>yes</p></td>
<td><p><span>The Merkely command to execute. This page documents a value of </span><span class="inline-code">log_test</span><span></span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_FINGERPRINT</p></td>
<td><p>yes</p></td>
<td><p>The artifact’s <a class="reference external" href="../../fingerprints/docker_fingerprint.html">Fingerprint</a></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_EVIDENCE_TYPE</p></td>
<td><p>yes</p></td>
<td><p><span>The evidence type.</span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_TEST_RESULTS_DIR</p></td>
<td><p>no</p></td>
<td><p><span>The directory where Merkely will look for JUnit .xml files. Must be volume-mounted in the container. Defaults to </span><span class="inline-code">/data/junit/</span><span></span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_DESCRIPTION</p></td>
<td><p>no</p></td>
<td><p><span>A description of the test summary. Defaults to “JUnit results xml verified by merkely/change: ” followed by a summary, eg “All tests passed in 1 test suites”</span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_CI_BUILD_URL</p></td>
<td><p>no</p></td>
<td><p><span>Link to the build in the ci system. Defaults to </span><span class="inline-code">${GITHUB_SERVER_URL}/${GITHUB_REPOSITORY}/actions/runs/${GITHUB_RUN_ID}</span><span></span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_USER_DATA</p></td>
<td><p>no</p></td>
<td><p><span>A pathed filename containing json content to embed in the data logged to Merkely. If provided, must be volume-mounted in the container. If not provided, the json content defaults to </span><span class="inline-code">{}</span><span></span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_OWNER</p></td>
<td><p>yes</p></td>
<td><p><span>Your user/organization name in Merkely.</span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_PIPELINE</p></td>
<td><p>yes</p></td>
<td><p><span>Your pipeline name in your user/organization in Merkely.</span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_API_TOKEN</p></td>
<td><p>yes</p></td>
<td><p><span>Your secret API token for Merkely. Set this to </span><span class="inline-code">“DRY_RUN”</span><span> to turn off all commands in all pipelines.</span></p></td>
</tr>
<tr class="row-even"><td><p>MERKELY_HOST</p></td>
<td><p>no</p></td>
<td><p><span>The API hostname for Merkely. Defaults to </span><span class="inline-code">https://app.merkely.com</span><span></span></p></td>
</tr>
<tr class="row-odd"><td><p>MERKELY_DRY_RUN</p></td>
<td><p>no</p></td>
<td><p><span>When set to </span><span class="inline-code">“TRUE”</span><span>, prints the command’s url+payload, does not make any HTTP calls to Merkely, and exits the command with a zero status code. Defaults to </span><span class="inline-code">“FALSE”</span><span>. See also setting the MERKELY_API_TOKEN (above) to code:`DRY_RUN`.</span></p></td>
</tr>
</tbody>
</table>
</div>
</div></div>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Merkely.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>